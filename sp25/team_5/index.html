<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AFK Hero - Project Journal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #222;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .container {
            padding: 20px;
            max-width: 900px;
            margin: auto;
            background-color: white;
        }
        h2 {
            color: #444;
        }
        code {
            background-color: #eee;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }
        pre {
            background-color: #eee;
            padding: 10px;
            overflow-x: auto;
        }
        .error {
            background-color: #ffe6e6;
            padding: 10px;
            border-left: 4px solid red;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>AFK Hero: A Raspberry Pi HID Adventure</h1>
    </header>
    <div class="container">
        <h2>Overview</h2>
        <p>AFK Hero began as an ambitious project: to create a Raspberry Pi touchscreen interface that acts as a USB HID device, capable of sending keystrokes to a connected host PC. The goal was to launch a GUI, write paragraphs or generate random words, and mimic user activity.</p>

        <h2>What We Built</h2>
        <ul>
            <li>A Tkinter-based fullscreen GUI with buttons for two actions: "Paragraph Writing" and "Random Word Generator"</li>
            <li>Python threading to enable background typing over HID</li>
            <li>Systemd services to autoload the GUI and HID gadget on boot</li>
        </ul>

        <h2>Key Components</h2>
        <h3>hid-setup.sh</h3>
        <pre><code>#!/bin/bash
modprobe libcomposite
cd /sys/kernel/config/usb_gadget/
mkdir -p hidgadget
cd hidgadget

echo 0x1d6b > idVendor  # Linux Foundation
echo 0x0104 > idProduct # HID Gadget
echo 0x0100 > bcdDevice
echo 0x0200 > bcdUSB

mkdir -p strings/0x409
echo "1234567890" > strings/0x409/serialnumber
echo "AFK Hero" > strings/0x409/manufacturer
echo "AFK Keyboard" > strings/0x409/product

mkdir -p configs/c.1/strings/0x409
echo "Config 1: HID" > configs/c.1/strings/0x409/configuration
echo 120 > configs/c.1/MaxPower

mkdir -p functions/hid.usb0
echo 1 > functions/hid.usb0/protocol
echo 1 > functions/hid.usb0/subclass
echo 8 > functions/hid.usb0/report_length

echo -ne '\x05\x01\x09\x06\xa1\x01\x05\x07\x19\xe0\x29\xe7\x15\x00\x25\x01\x75\x01\x95\x08\x81\x02\x95\x01\x75\x08\x81\x01\x95\x05\x75\x01\x05\x08\x19\x01\x29\x05\x91\x02\x95\x01\x75\x03\x91\x01\x95\x06\x75\x08\x15\x00\x25\x65\x05\x07\x19\x00\x29\x65\x81\x00\xc0' \
  > functions/hid.usb0/report_desc

ln -s functions/hid.usb0 configs/c.1/
echo $(ls /sys/class/udc) > UDC</code></pre>

        <h3>Python GUI Excerpt</h3>
        <pre><code>def type_string(s, delay=0.2):
    with open("/dev/hidg0", "wb") as f:
        for char in s:
            code = ascii_to_keycode(char)
            if code:
                f.write(code)
                f.write(b"\x00\x00\x00\x00\x00\x00\x00\x00")
                time.sleep(delay)

root = tk.Tk()
root.title("AFK Hero")
root.attributes("-fullscreen", True)
... # GUI setup</code></pre>

        <h2>The Problem</h2>
        <div class="error">
            <strong>We hit a wall:</strong> Despite all services loading and GUI working, the Pi never emulated a USB keyboard successfully. No sound or recognition on host PCs, and attempts to reset or rebind the UDC device failed with:
            <code>No such device / Device or resource busy</code>
        </div>

        <p>Even elevated permissions as <code>root</code> failed to clean up or reinitialize the HID gadget device directory.</p>

        <h2>Conclusion</h2>
        <p>AFK Hero remains a compelling prototype — complete with code, interface, and automation — but was ultimately blocked by a stubborn kernel-level HID issue. Whether due to hardware incompatibility, kernel config, or UDC binding conflict, the end goal remains elusive. But the journey was worth every keystroke.</p>

        <p><strong>Next Steps:</strong> Flash a fresh Pi OS image, ensure correct boot config, or consider alternate USB OTG methods or different Pi models (e.g., Pi Zero 2 W).</p>

        <p><em>Stay AFK, but stay heroic.</em></p>
    </div>
</body>
</html>

